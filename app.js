/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ãƒ‡ãƒ¼ã‚¿å®šç¾©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

// ã‚¿ãƒ­ãƒƒãƒˆ 78æš
const TAROT = [
  // å¤§ã‚¢ãƒ«ã‚«ãƒŠï¼ˆ22æšï¼‰
  'æ„šè€…ï¼ˆ0ï¼‰', 'é­”è¡“å¸«ï¼ˆâ… ï¼‰', 'å¥³æ•™çš‡ï¼ˆâ…¡ï¼‰', 'å¥³å¸ï¼ˆâ…¢ï¼‰', 'çš‡å¸ï¼ˆâ…£ï¼‰',
  'æ•™çš‡ï¼ˆâ…¤ï¼‰', 'æ‹äººãŸã¡ï¼ˆâ…¥ï¼‰', 'æˆ¦è»Šï¼ˆâ…¦ï¼‰', 'åŠ›ï¼ˆâ…§ï¼‰', 'éš è€…ï¼ˆâ…¨ï¼‰',
  'é‹å‘½ã®è¼ªï¼ˆâ…©ï¼‰', 'æ­£ç¾©ï¼ˆâ…ªï¼‰', 'åŠã‚‹ã•ã‚ŒãŸç”·ï¼ˆâ…«ï¼‰', 'æ­»ç¥ï¼ˆâ…©â…¢ï¼‰',
  'ç¯€åˆ¶ï¼ˆâ…©â…£ï¼‰', 'æ‚ªé­”ï¼ˆâ…©â…¤ï¼‰', 'å¡”ï¼ˆâ…©â…¥ï¼‰', 'æ˜Ÿï¼ˆâ…©â…¦ï¼‰', 'æœˆï¼ˆâ…©â…§ï¼‰',
  'å¤ªé™½ï¼ˆâ…©â…¨ï¼‰', 'å¯©åˆ¤ï¼ˆâ…©â…©ï¼‰', 'ä¸–ç•Œï¼ˆâ…©â…ªï¼‰',
  // ãƒ¯ãƒ³ãƒ‰ï¼ˆ14æšï¼‰
  'ãƒ¯ãƒ³ãƒ‰ã®ã‚¨ãƒ¼ã‚¹', 'ãƒ¯ãƒ³ãƒ‰ã®2', 'ãƒ¯ãƒ³ãƒ‰ã®3', 'ãƒ¯ãƒ³ãƒ‰ã®4', 'ãƒ¯ãƒ³ãƒ‰ã®5',
  'ãƒ¯ãƒ³ãƒ‰ã®6', 'ãƒ¯ãƒ³ãƒ‰ã®7', 'ãƒ¯ãƒ³ãƒ‰ã®8', 'ãƒ¯ãƒ³ãƒ‰ã®9', 'ãƒ¯ãƒ³ãƒ‰ã®10',
  'ãƒ¯ãƒ³ãƒ‰ã®ãƒšã‚¤ã‚¸', 'ãƒ¯ãƒ³ãƒ‰ã®ãƒŠã‚¤ãƒˆ', 'ãƒ¯ãƒ³ãƒ‰ã®ã‚¯ã‚¤ãƒ¼ãƒ³', 'ãƒ¯ãƒ³ãƒ‰ã®ã‚­ãƒ³ã‚°',
  // ã‚«ãƒƒãƒ—ï¼ˆ14æšï¼‰
  'ã‚«ãƒƒãƒ—ã®ã‚¨ãƒ¼ã‚¹', 'ã‚«ãƒƒãƒ—ã®2', 'ã‚«ãƒƒãƒ—ã®3', 'ã‚«ãƒƒãƒ—ã®4', 'ã‚«ãƒƒãƒ—ã®5',
  'ã‚«ãƒƒãƒ—ã®6', 'ã‚«ãƒƒãƒ—ã®7', 'ã‚«ãƒƒãƒ—ã®8', 'ã‚«ãƒƒãƒ—ã®9', 'ã‚«ãƒƒãƒ—ã®10',
  'ã‚«ãƒƒãƒ—ã®ãƒšã‚¤ã‚¸', 'ã‚«ãƒƒãƒ—ã®ãƒŠã‚¤ãƒˆ', 'ã‚«ãƒƒãƒ—ã®ã‚¯ã‚¤ãƒ¼ãƒ³', 'ã‚«ãƒƒãƒ—ã®ã‚­ãƒ³ã‚°',
  // ã‚½ãƒ¼ãƒ‰ï¼ˆ14æšï¼‰
  'ã‚½ãƒ¼ãƒ‰ã®ã‚¨ãƒ¼ã‚¹', 'ã‚½ãƒ¼ãƒ‰ã®2', 'ã‚½ãƒ¼ãƒ‰ã®3', 'ã‚½ãƒ¼ãƒ‰ã®4', 'ã‚½ãƒ¼ãƒ‰ã®5',
  'ã‚½ãƒ¼ãƒ‰ã®6', 'ã‚½ãƒ¼ãƒ‰ã®7', 'ã‚½ãƒ¼ãƒ‰ã®8', 'ã‚½ãƒ¼ãƒ‰ã®9', 'ã‚½ãƒ¼ãƒ‰ã®10',
  'ã‚½ãƒ¼ãƒ‰ã®ãƒšã‚¤ã‚¸', 'ã‚½ãƒ¼ãƒ‰ã®ãƒŠã‚¤ãƒˆ', 'ã‚½ãƒ¼ãƒ‰ã®ã‚¯ã‚¤ãƒ¼ãƒ³', 'ã‚½ãƒ¼ãƒ‰ã®ã‚­ãƒ³ã‚°',
  // ãƒšãƒ³ã‚¿ã‚¯ãƒ«ï¼ˆ14æšï¼‰
  'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ã‚¨ãƒ¼ã‚¹', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®2', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®3', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®4', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®5',
  'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®6', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®7', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®8', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®9', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®10',
  'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ãƒšã‚¤ã‚¸', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ãƒŠã‚¤ãƒˆ', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ã‚¯ã‚¤ãƒ¼ãƒ³', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ã‚­ãƒ³ã‚°',
];


const TAROT_SYMBOL = {
  'å¤§ã‚¢ãƒ«ã‚«ãƒŠ': 'âœ¨', 'ãƒ¯ãƒ³ãƒ‰': 'ğŸ”¥', 'ã‚«ãƒƒãƒ—': 'ğŸ’§', 'ã‚½ãƒ¼ãƒ‰': 'âš¡', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«': 'ğŸŒ¿',
};
const ORACLE_SYMBOLS = ['ğŸŒ™','â­','ğŸŒ¸','ğŸ¦‹','ğŸŒº','ğŸŒˆ','ğŸ”®','ğŸŒŸ','ğŸ’','ğŸŒŠ','â˜€ï¸','ğŸŒ¿'];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   è¨­å®š / APIã‚­ãƒ¼ç®¡ç†
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

const API_KEY_STORAGE = 'tarot_claude_api_key';

function openSettings() {
  const key = localStorage.getItem(API_KEY_STORAGE) || '';
  document.getElementById('apiKeyInput').value = key;
  document.getElementById('apiSavedNotice').classList.remove('show');
  document.getElementById('settingsModal').classList.add('show');
}

function closeSettings() {
  document.getElementById('settingsModal').classList.remove('show');
}

function handleOverlayClick(e) {
  if (e.target === document.getElementById('settingsModal')) closeSettings();
}

function saveApiKey() {
  const key = document.getElementById('apiKeyInput').value.trim();
  localStorage.setItem(API_KEY_STORAGE, key);
  document.getElementById('apiSavedNotice').classList.add('show');
  setTimeout(() => {
    document.getElementById('apiSavedNotice').classList.remove('show');
  }, 2000);
}

function toggleApiKeyVisibility() {
  const input = document.getElementById('apiKeyInput');
  input.type = input.type === 'password' ? 'text' : 'password';
}

function getApiKey() {
  return localStorage.getItem(API_KEY_STORAGE) || '';
}

// Esc ã‚­ãƒ¼ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') closeSettings();
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼ˆClaude APIï¼‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

let profileData = null;

function showAlert(html, type = 'error') {
  const el = document.getElementById('profilingAlert');
  el.innerHTML = `<div class="alert alert-${type}">${html}</div>`;
}

function clearAlert() {
  document.getElementById('profilingAlert').innerHTML = '';
}

async function runProfiling() {
  const lineText = document.getElementById('lineText').value.trim();
  if (!lineText) {
    showAlert('LINEã®ã‚„ã‚Šå–ã‚Šã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚');
    return;
  }

  const apiKey = getApiKey();
  if (!apiKey) {
    showAlert(
      'Claude APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br/>' +
      'ç”»é¢å³ä¸Šã® <strong>âš™ï¸</strong> ã‹ã‚‰APIã‚­ãƒ¼ã‚’å…¥åŠ›ãƒ»ä¿å­˜ã—ã¦ãã ã•ã„ã€‚',
      'info'
    );
    return;
  }

  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹
  const btn = document.getElementById('profileBtn');
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span> è§£æä¸­...';
  clearAlert();
  document.getElementById('profileResult').classList.remove('show');

  const prompt = `ä»¥ä¸‹ã®LINEãƒˆãƒ¼ã‚¯å±¥æ­´ã‚’åˆ†æã—ã¦ã€ã‚¿ãƒ­ãƒƒãƒˆå ã„å¸«ãŒé‘‘å®šã‚’è¡Œã†ãŸã‚ã«å¿…è¦ãªæƒ…å ±ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚

ã€LINEãƒˆãƒ¼ã‚¯å±¥æ­´ã€‘
${lineText}

ä»¥ä¸‹ã®JSONå½¢å¼ã®ã¿ã§å›ç­”ã—ã¦ãã ã•ã„ï¼ˆèª¬æ˜æ–‡ã¯ä¸è¦ï¼‰ã€‚å€¤ãŒä¸æ˜ãƒ»èª­ã¿å–ã‚Œãªã„å ´åˆã¯ "ä¸æ˜" ã¨è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚

{
  "name": "ç›¸è«‡è€…ã®åå‰ï¼ˆãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã§ã‚‚å¯ï¼‰",
  "gender": "ç›¸è«‡è€…ã®æ€§åˆ¥ï¼ˆå¥³æ€§ï¼ç”·æ€§ï¼ä¸æ˜ï¼‰",
  "partner_gender": "ç›¸æ‰‹ã®æ€§åˆ¥ï¼ˆå¥³æ€§ï¼ç”·æ€§ï¼ä¸æ˜ï¼‰",
  "relationship": "ç›¸æ‰‹ã¨ã®é–¢ä¿‚æ€§ï¼ˆä¾‹ï¼šäº¤éš›ä¸­ã®å½¼æ°ï¼å…ƒã‚«ãƒ¬ï¼ç‰‡æ€ã„ã®ç›¸æ‰‹ï¼ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ—ãƒªã§çŸ¥ã‚Šåˆã£ãŸç”·æ€§ï¼ãªã©ã€‚å…·ä½“çš„ã«ï¼‰",
  "status": "ç¾åœ¨ã®çŠ¶æ³ã‚’å…·ä½“çš„äº‹å®Ÿãƒ™ãƒ¼ã‚¹ã§ï¼ˆä¾‹ï¼šäº¤éš›2å¹´ç›®ã€3æœˆã‹ã‚‰é è·é›¢äºˆå®šã€æœ€è¿‘é€£çµ¡é »åº¦ãŒæ¸›å°‘ã€å…ˆæ—¥ã€Œã‚«ãƒ•ã‚§ã§è©±ã—ãŸã„ã€ã¨è¨€ã‚ã‚ŒãŸã€ãªã©ã€‚äº‹å®Ÿã‚’æ™‚ç³»åˆ—ã§ç®‡æ¡æ›¸ãï¼‰",
  "theme": "é‘‘å®šãƒ†ãƒ¼ãƒã‚’ä¸€è¨€ã§ï¼ˆä¾‹ï¼šå½¼ã®æ°—æŒã¡ï¼å¾©ç¸ã®å¯èƒ½æ€§ï¼ã‚«ãƒ•ã‚§ã§è©±ã•ã‚Œã‚‹å†…å®¹ã®æœ¬éŸ³ï¼‰",
  "deepest_fear": "ç›¸è«‡è€…ãŒä¸€ç•ªæ€–ã„ã¨æ„Ÿã˜ã¦ã„ã‚‹ã“ã¨ãƒ»æœ€ã‚‚ä¸å®‰ã«æ€ã£ã¦ã„ã‚‹ã“ã¨ï¼ˆä¾‹ï¼šåˆ¥ã‚Œè©±ã‚’ã•ã‚Œã‚‹ã“ã¨ã€æ°—æŒã¡ã®æ¸©åº¦å·®ã‚’çªãã¤ã‘ã‚‰ã‚Œã‚‹ã“ã¨ã€ãªã©ã€‚LINEã®æ–‡é¢ã‹ã‚‰æ„Ÿæƒ…ãƒ¬ãƒ™ãƒ«ã§èª­ã¿å–ã‚‹ï¼‰",
  "summary": "ç›¸è«‡å†…å®¹ã®è¦ç´„ï¼ˆ3ã€œ5æ–‡ã§å…·ä½“çš„ã«ã€‚äº‹å®Ÿã ã‘ã§ãªãã€ç›¸è«‡è€…ãŒã©ã‚“ãªæ„Ÿæƒ…çŠ¶æ…‹ã«ã‚ã‚‹ã‹ã‚‚å«ã‚ã‚‹ï¼‰",
  "personality": "ç›¸è«‡è€…ã®æ€§æ ¼ãƒ»ç‰¹å¾´ï¼ˆæ–‡ç« ã‹ã‚‰èª­ã¿å–ã‚Œã‚‹ã“ã¨ã€‚ä¾‹ï¼šç›¸æ‰‹ã®æ°—æŒã¡ã‚’å…ˆå›ã‚Šã—ã¦è€ƒãˆã‚‹ã‚¿ã‚¤ãƒ—ã€ä¸å®‰ã‚’ä¸€äººã§æŠ±ãˆè¾¼ã¿ã‚„ã™ã„ã€èŠ¯ã¯å¼·ã„ãŒè¡¨ã«å‡ºã•ãªã„ã€ãªã©ï¼‰",
  "strengths": "ç›¸è«‡è€…ã®æ„›ã•ã‚Œã‚‹è³‡è³ªãƒ»å¼·ã•ï¼ˆä¾‹ï¼šæ€–ã„ã®ã«é€ƒã’ãšã«å‘ãåˆãŠã†ã¨ã—ã¦ã„ã‚‹ã€é è·é›¢ã‚‚è¦šæ‚Ÿã§ãã‚‹ã»ã©æ„›æƒ…ãŒæ·±ã„ã€ãªã©ã€‚é‘‘å®šæ–‡ã®ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ã§è‚¯å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ï¼‰",
  "unconfirmed": "é‘‘å®šå‰ã«ç¢ºèªã—ã¦ãŠãã¹ãæœªç¢ºèªäº‹é …ï¼ˆè¤‡æ•°ã‚ã‚Œã°æ”¹è¡ŒåŒºåˆ‡ã‚Šã§åˆ—æŒ™ï¼‰"
}`;

  try {
    const res = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: {
        'content-type': 'application/json',
        'x-api-key': apiKey,
        'anthropic-version': '2023-06-01',
        'anthropic-dangerous-direct-browser-access': 'true',
      },
      body: JSON.stringify({
        model: 'claude-sonnet-4-6',
        max_tokens: 1024,
        messages: [{ role: 'user', content: prompt }],
      }),
    });

    if (!res.ok) {
      const err = await res.json().catch(() => ({}));
      const msg = err?.error?.message || `HTTPã‚¨ãƒ©ãƒ¼ ${res.status}`;
      if (res.status === 401) {
        throw new Error('APIã‚­ãƒ¼ãŒç„¡åŠ¹ã§ã™ã€‚è¨­å®šç”»é¢ã§ã‚­ãƒ¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
      }
      throw new Error(msg);
    }

    const data = await res.json();
    const raw = data?.content?.[0]?.text || '';

    // JSONéƒ¨åˆ†ã‚’æŠ½å‡º
    const jsonMatch = raw.match(/\{[\s\S]*\}/);
    if (!jsonMatch) throw new Error('APIã®å¿œç­”ã‹ã‚‰JSONã‚’èª­ã¿å–ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚');

    profileData = JSON.parse(jsonMatch[0]);
    displayProfile(profileData);

    // ã‚«ãƒ¼ãƒ‰ãŒæ—¢ã«å¼•ã‹ã‚Œã¦ã„ã‚‹å ´åˆã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å†ç”Ÿæˆ
    if (drawnCards) generatePrompt();

  } catch (e) {
    showAlert(`ã‚¨ãƒ©ãƒ¼ï¼š${e.message}`);
  } finally {
    btn.disabled = false;
    btn.innerHTML = 'ğŸ” ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°å®Ÿè¡Œ';
  }
}

function displayProfile(p) {
  document.getElementById('pName').textContent         = p.name            || 'â€”';
  document.getElementById('pGender').textContent       = p.gender          || 'â€”';
  document.getElementById('pRelationship').textContent = (p.partner_gender && p.relationship)
    ? `${p.partner_gender} / ${p.relationship}`
    : p.relationship || 'â€”';
  document.getElementById('pStatus').textContent       = p.status          || 'â€”';
  document.getElementById('pTheme').textContent        = p.theme           || 'â€”';
  document.getElementById('pFear').textContent         = p.deepest_fear    || 'â€”';
  document.getElementById('pSummary').textContent      = p.summary         || 'â€”';
  document.getElementById('pPersonality').textContent  = p.personality     || 'â€”';
  document.getElementById('pStrengths').textContent    = p.strengths       || 'â€”';
  document.getElementById('pUnconfirmed').textContent  = p.unconfirmed     || 'â€”';
  document.getElementById('profileResult').classList.add('show');
  setTimeout(() => {
    document.getElementById('profileResult').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }, 80);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function pick(arr, n) { return shuffle(arr).slice(0, n); }

function randomPosition() { return Math.random() < 0.5 ? 'æ­£ä½ç½®' : 'é€†ä½ç½®'; }

function getSymbol(cardName) {
  if (ORACLE.includes(cardName)) {
    return ORACLE_SYMBOLS[Math.floor(Math.random() * ORACLE_SYMBOLS.length)];
  }
  const idx = TAROT.indexOf(cardName);
  if (idx < 22) return TAROT_SYMBOL['å¤§ã‚¢ãƒ«ã‚«ãƒŠ'];
  if (idx < 36) return TAROT_SYMBOL['ãƒ¯ãƒ³ãƒ‰'];
  if (idx < 50) return TAROT_SYMBOL['ã‚«ãƒƒãƒ—'];
  if (idx < 64) return TAROT_SYMBOL['ã‚½ãƒ¼ãƒ‰'];
  return TAROT_SYMBOL['ãƒšãƒ³ã‚¿ã‚¯ãƒ«'];
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

let drawnCards = null;

function drawCards() {
  const [t1, t2] = pick(TAROT, 2).map(c => ({ name: c, pos: randomPosition(), isTarot: true }));
  const [o1, o2, o3, o4] = pick(ORACLE, 4).map(c => ({ name: c, pos: randomPosition(), isTarot: false }));

  const topCards    = [t1, o1, o2];
  const bottomCards = [t2, o3, o4];
  drawnCards = { top: topCards, bottom: bottomCards };

  const topRow    = document.getElementById('topRow');
  const bottomRow = document.getElementById('bottomRow');
  topRow.innerHTML    = '';
  bottomRow.innerHTML = '';

  [...topCards, ...bottomCards].forEach((card, i) => {
    const row    = i < 3 ? topRow : bottomRow;
    const sym    = getSymbol(card.name);
    const rev    = card.pos === 'é€†ä½ç½®';
    const tClass = card.isTarot ? 'tarot-card' : 'oracle-card';
    const badge  = card.isTarot ? 'ã‚¿ãƒ­ãƒƒãƒˆ' : 'ã‚ªãƒ©ã‚¯ãƒ«';
    row.innerHTML += `
      <div class="card-item ${tClass}${rev ? ' reversed-card' : ''}">
        <div class="card-type-badge">${badge}</div>
        <span class="card-symbol">${sym}</span>
        <div class="card-name">${card.name}</div>
        <span class="card-position ${rev ? 'pos-reversed' : 'pos-upright'}">${card.pos}</span>
      </div>`;
  });

  document.getElementById('cardStage').classList.add('show');
  generatePrompt();
  document.getElementById('promptSection').classList.add('show');

  setTimeout(() => {
    document.getElementById('cardStage').scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 100);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function getOracleDetail(cardDisplayName, position) {
  const card = ORACLE_CARDS.find(c => c.displayName === cardDisplayName);
  if (!card) return null;
  const animalName = cardDisplayName.split('ã¨')[0];
  return {
    animalName: animalName,
    keyword: card.keyword_ja,
    meaning: position === 'æ­£ä½ç½®' ? card.upright : card.reversed,
  };
}

function generatePrompt() {
  const p = profileData || {};
  const name          = p.name          || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const gender        = p.gender        || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const partnerGender = p.partner_gender || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const relationship  = p.relationship  || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const status        = p.status        || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const theme         = p.theme         || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const deepestFear   = p.deepest_fear  || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const summary       = p.summary       || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const personality   = p.personality   || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const strengths     = p.strengths     || 'ï¼ˆæœªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ï¼‰';
  const unconfirmed   = p.unconfirmed   || 'ï¼ˆãªã—ï¼‰';

  const { top, bottom } = drawnCards;

  // ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
  const fmtTarot = (c) => `${c.name}ï¼ˆ${c.pos}ï¼‰`;

  // ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆå‹•ç‰©åï¼‹ä½ç½®ï¼‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‹æ„å‘³ï¼‰
  const fmtOracle = (c) => {
    const detail = getOracleDetail(c.name, c.pos);
    if (!detail) return `${c.name}ï¼ˆ${c.pos}ï¼‰`;
    return `${c.name}ï¼ˆ${c.pos}ï¼‰
    ãƒ»å‹•ç‰©åï¼ˆæœ¬æ–‡ã§ä½¿ç”¨ã™ã‚‹åå‰ï¼‰ï¼š${detail.animalName}
    ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼š${detail.keyword}
    ãƒ»ã“ã®ä½ç½®ã§ã®æ„å‘³ï¼š${detail.meaning}`;
  };

  // --- æ–‡ä½“ã‚µãƒ³ãƒ—ãƒ« ---
  const sampleOpening = `ã•ãªã•ã‚“ãŒä»Šä¸€ç•ªæ€–ã„ã¨æ„Ÿã˜ã¦ã„ã‚‹ã®ã¯ã€ã€Œåˆ¥ã‚Œè©±ã‚’ã•ã‚Œã‚‹ã“ã¨ã€ãã®ã‚‚ã®ã ã‘ã§ã¯ãªã„ã¨æ€ã†ã‚“ã§ã™ã€‚æœ¬å½“ã«æ€–ã„ã®ã¯ã€ã€Œç§ã¯ã“ã‚“ãªã«å¥½ããªã®ã«ã€å½¼ã¯ã‚‚ã†ãã†ã˜ã‚ƒãªã„ã‹ã‚‚ã—ã‚Œãªã„ã€ã¨ã„ã†ã€æ°—æŒã¡ã®æ¸©åº¦å·®ã‚’çªãã¤ã‘ã‚‰ã‚Œã‚‹ã“ã¨ã§ã¯ãªã„ã§ã™ã‹ã€‚é€£çµ¡ãŒæ¸›ã£ãŸã€‚ä¼šãˆãªããªã£ãŸã€‚ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—ã‚‚æ¸›ã£ãŸã€‚ãã®ä¸€ã¤ã²ã¨ã¤ã«ã€Œå†·ã‚ãŸã®ã‹ãªã€ã¨ã„ã†ç¿»è¨³ã‚’è²¼ã‚Šã¤ã‘ã¦ã€ã§ã‚‚ãã‚Œã‚’ç¢ºã‹ã‚ã‚‹ã®ãŒæ€–ãã¦ã€ãšã£ã¨ä¸€äººã§æŠ±ãˆè¾¼ã‚“ã§ãã¾ã—ãŸã‚ˆã­ã€‚`;

  const sampleReading = `ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã¯ã€Œãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®6ã€ãŒæ­£ä½ç½®ã§å‡ºã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯æœ¬æ¥ã€Œã‚®ãƒ–ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ»ãƒ†ã‚¤ã‚¯ã€ã‚„ã€Œå…¬å¹³ãªé…åˆ†ã€ã‚’è¡¨ã™ã‚«ãƒ¼ãƒ‰ã§ã™ã€‚ã§ã™ãŒã€ä»Šã®å½¼ã®çŠ¶æ³ã§èª­ã‚€ã¨ã€å½¼ã¯è‡ªåˆ†ã®ä¸­ã®é™ã‚‰ã‚ŒãŸã€Œå¿ƒã®ãƒãƒƒãƒ†ãƒªãƒ¼ã€ã®é…åˆ†ã«å¿…æ­»ã«ãªã£ã¦ã„ã‚‹å§¿ãŒè¦‹ãˆã¾ã™ã€‚å½¼ã«ã¨ã£ã¦ã€å‹é”ã¨éŠã¶ã“ã¨ã¯ã€Œæ¶ˆè²»ã€ã§ã¯ãªãã€Œå……é›»ã€ã§ã™ã€‚ä¸€æ–¹ã§ã€ä»Šã®ãŠã•ã•ã‚“ã¸ã®è¿”ä¿¡ã¯ã€å½¼ã®ä¸­ã§ã€Œè²¬ä»»ã€ã‚„ã€Œèª¬æ˜ã€ã‚’ä¼´ã†ã€éå¸¸ã«ã‚«ãƒ­ãƒªãƒ¼ã®é«˜ã„ã‚¿ã‚¹ã‚¯ã«ãªã£ã¦ã—ã¾ã£ã¦ã„ã‚‹ã®ã§ã™ã€‚ã¤ã¾ã‚Šã€ã€ŒãŠã•ã•ã‚“ãŒå¤§äº‹ã˜ã‚ƒãªã„ã€ã‹ã‚‰å¾Œå›ã—ã«ã—ã¦ã„ã‚‹ã®ã§ã¯ãªãã€ãŠã•ã•ã‚“ã¨çœŸå‰£ã«å‘ãåˆã†ãŸã‚ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæ¯æ¸‡ã—ã¦ã„ã‚‹ã‹ã‚‰ã€å…ˆã«å‹é”ã¨ã„ã†ã‚¬ã‚½ãƒªãƒ³ã‚¹ã‚¿ãƒ³ãƒ‰ã§çµ¦æ²¹ã—ã¦ã„ã‚‹ã€‚ã‚«ãƒ¼ãƒ‰ã¯ãã†å‘Šã’ã¦ã„ã¾ã™ã€‚`;

  const sampleAction = `ã¾ãšã€ã‚«ãƒ•ã‚§ã§ã€Œã‚„ã‚‹ã“ã¨ã€ã§ã™ã€‚å½¼ãŒè©±ã—å§‹ã‚ãŸã‚‰ã€æœ€å¾Œã¾ã§èãåˆ‡ã£ã¦ãã ã•ã„ã€‚é€”ä¸­ã§ã©ã‚“ãªã«èƒ¸ãŒè‹¦ã—ããªã£ã¦ã‚‚ã€é®ã‚‰ãªã„ã“ã¨ã€‚æ¶™ãŒå‡ºã¦ã—ã¾ã£ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚ã§ã‚‚ã€å½¼ãŒè¨€ã„çµ‚ã‚ã‚‹ã¾ã§ã¯ã¾ãšèãã€‚ãªãœãªã‚‰ã€ã‚³ãƒ¨ãƒ¼ãƒ†ã®ã‚«ãƒ¼ãƒ‰ãŒç¤ºã—ã¦ã„ã‚‹ã‚ˆã†ã«ã€å½¼ã®è©±ã«ã¯ã€Œè¡¨é¢çš„ãªç†ç”±ã€ã¨ã€Œæœ¬å½“ã®æ ¸å¿ƒã€ãŒæ··ã–ã£ã¦ã„ã¾ã™ã€‚æœ€å¾Œã¾ã§èã‹ãªã„ã¨ã€è¡¨é¢çš„ãªç†ç”±ã ã‘ã‚’æ‹¾ã£ã¦åå¿œã—ã¦ã—ã¾ã†å±é™ºãŒã‚ã‚Šã¾ã™ã€‚`;

  const sampleEnding = `å½¼ãŒã©ã‚“ãªè©±ã‚’ã—ã¦ãã¦ã‚‚ã€é è·é›¢ãŒã©ã†ãªã£ã¦ã‚‚ã€ã•ãªã•ã‚“ãŒã“ã‚Œã ã‘çœŸå‰£ã«ä¸€äººã®äººã‚’æ„›ã›ã‚‹ã¨ã„ã†ã“ã¨ã€‚æ€–ã„ã®ã«é€ƒã’ãšã«å‘ãåˆãŠã†ã¨ã—ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã€‚ãã‚Œè‡ªä½“ãŒã€ã•ãªã•ã‚“ã®ä¾¡å€¤ã§ã™ã€‚çµæœãŒã©ã†è»¢ã‚“ã§ã‚‚ã€æºã‚‰ãŒãªã„ä¾¡å€¤ã§ã™ã€‚`;

  const prompt = `ã‚ãªãŸã¯TikTokã§å¤§äººæ°—ã®ã€Œç”·æ€§å¿ƒç†ç¿»è¨³å®¶ï½œæ‹æ„›å ã„å¸«ãƒ¬ãƒ³ã€ã§ã™ã€‚ä»¥ä¸‹ã®ã€Œé¡§å®¢ã‚«ãƒ«ãƒ†ã€ã¨ã€Œã‚«ãƒ¼ãƒ‰å±•é–‹çµæœã€ã‚’å…ƒã«ã€ç›¸è«‡è€…ã«ãã®ã¾ã¾PDFã§ç´å“ã™ã‚‹ã€Œæ–‡å­—é‘‘å®šãƒ¬ãƒãƒ¼ãƒˆã€ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
â€» å„ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã®æ„å‘³ã«ã¤ã„ã¦ã¯ã€ã€Œã‚«ãƒ¼ãƒ‰å±•é–‹çµæœã€å†…ã«è¨˜è¼‰ã•ã‚ŒãŸæƒ…å ±ã‚’å…ƒã«ã—ã¦ãã ã•ã„ã€‚

âš  æœ€é‡è¦ãƒ»çµ¶å¯¾éµå®ˆãƒ«ãƒ¼ãƒ«ï¼ˆHard Constraintsï¼‰
ã“ã®å‡ºåŠ›ã¯ã€ãã®ã¾ã¾PDFã«å¤‰æ›ã—ã¦ç›¸è«‡è€…ã«ç´å“ã™ã‚‹å®ŒæˆåŸç¨¿ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€ä»¥ä¸‹ã‚’çµ¶å¯¾ã«å®ˆã£ã¦ãã ã•ã„ã€‚

1. ã€Œèªã‚Šã‹ã‘å£èª¿ã€ã®å¾¹åº•
æ›¸ãè¨€è‘‰ã®ãƒ¬ãƒãƒ¼ãƒˆã§ã¯ãªãã€ãƒ¬ãƒ³ãŒç›¸è«‡è€…ã«ç›´æ¥èªã‚Šã‹ã‘ã¦ã„ã‚‹ã‚ˆã†ãªæ¸©ã‹ã„æ–‡ä½“ã§æ›¸ãã“ã¨ã€‚ãŸã ã—å‹•ç”»å°æœ¬ã§ã¯ãªã„ãŸã‚ã€ã€Œï¼ˆé–“ï¼‰ã€ã€Œï¼ˆã‚«ãƒ¼ãƒ‰ã‚’å±•é–‹ã™ã‚‹éŸ³ï¼‰ã€ãªã©ã®æ¼”å‡ºæŒ‡ç¤ºã¯ä¸€åˆ‡ç¦æ­¢ã€‚

2. æ•¬èªãƒ¬ãƒ™ãƒ«ã®å³å®ˆï¼ˆæœ€é‡è¦ï¼‰
æ–‡ä½“ã¯ã€Œä¸å¯§èªï¼ˆã§ã™ãƒ»ã¾ã™ï¼‰ã€ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã™ã‚‹ã€‚å°Šæ•¬èªï¼ˆã€œã•ã‚Œã‚‹ã€ã€œã„ã‚‰ã£ã—ã‚ƒã‚‹ã€ãŠã€œã«ãªã‚‹ï¼‰ã¯åŸå‰‡ä½¿ç”¨ç¦æ­¢ã€‚è·é›¢ãŒé ããªã‚Šã™ãã‚‹ãŸã‚ã€‚ç›¸è«‡è€…ã®çŠ¶æ…‹ãƒ»è¡Œå‹•ãƒ»æ„Ÿæƒ…ã‚’æå†™ã™ã‚‹éš›ã‚‚ä¸å¯§èªã§çµ±ä¸€ã—ã€å¸¸ä½“ï¼ˆã‚¿ãƒ¡å£ï¼‰ã«ã—ãªã„ã€‚ãŸã ã—ã€Œã€œãªã‚“ã§ã™ã€ã€Œã€œãªã‚“ã§ã™ã‚ˆã€ç¨‹åº¦ã®èªå°¾ã®å´©ã—ã¯OKã€‚ã“ã‚Œã«ã‚ˆã‚Šå …ã™ããªã„è‡ªç„¶ãªèªã‚Šã«ãªã‚‹ã€‚è·é›¢æ„Ÿã®ç›®å®‰ï¼šã€Œä¿¡é ¼ã§ãã‚‹å¹´ä¸Šã®å‹äººãŒã€ä¸å¯§ã ã‘ã©å¿ƒã‚’è¾¼ã‚ã¦èªã‚Šã‹ã‘ã¦ã„ã‚‹ã€æ¸©åº¦æ„Ÿã€‚ã€Œã§ã‚‚ã­ã€ã€ã€Œã ã‹ã‚‰ã•ã€ã€ã®ã‚ˆã†ãªæ€¥ã«ã‚¿ãƒ¡å£ã«ãªã‚‹è¡¨ç¾ã¯ç¦æ­¢ã€‚ä¸å¯§èªã®ç¯„å›²å†…ã§è¦ªã—ã¿ã‚’å‡ºã™ã“ã¨ã€‚

æ•¬èªã®åˆ¤å®šåŸºæº–ï¼š
ãƒ»å°Šæ•¬èªï¼ˆè·é›¢ãŒé ã„ï¼‰â†’ NG ä¾‹ï¼šã€Œã•ãªã•ã‚“ãŒæŠ±ãˆè¾¼ã‚“ã§ã“ã‚‰ã‚ŒãŸã€
ãƒ»å¸¸ä½“ãƒ»ã‚¿ãƒ¡å£ï¼ˆè·é›¢ãŒè¿‘ã™ãã‚‹ï¼‰â†’ NG ä¾‹ï¼šã€Œã•ãªã•ã‚“ãŒæŠ±ãˆè¾¼ã‚“ã§ããŸã‚ˆã­ã€
ãƒ»ä¸å¯§èªï¼ˆã¡ã‚‡ã†ã©ã„ã„ï¼‰â†’ OK ä¾‹ï¼šã€Œã•ãªã•ã‚“ãŒæŠ±ãˆè¾¼ã‚“ã§ãã¾ã—ãŸã‚ˆã­ã€
ãƒ»ä¸å¯§èªï¼‹å´©ã—ï¼ˆè‡ªç„¶ãªèªã‚Šï¼‰â†’ OK ä¾‹ï¼šã€ŒæŠ±ãˆè¾¼ã‚“ã§ããŸã‚“ã§ã™ã‚ˆã­ã€

3. ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã®å‘¼ç§°ãƒ«ãƒ¼ãƒ«ï¼ˆæ¤ç‰©åå‰Šé™¤ï¼‰
ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã«ã¯é€šå¸¸ã€Œå‹•ç‰©ï¼‹æ¤ç‰©ã€ã®åå‰ãŒã¤ã„ã¦ã„ã¾ã™ãŒã€æœ¬æ–‡ã§ã¯ã€Œå‹•ç‰©åã€ã®ã¿ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
NGï¼šã€Œãƒã‚ºãƒŸã¨ã‚­ãƒ³ãƒã‚¦ã‚²ã®ã‚«ãƒ¼ãƒ‰ã€
OKï¼šã€Œãƒã‚ºãƒŸã®ã‚«ãƒ¼ãƒ‰ã€

4. ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã®çµµæŸ„æå†™ã«ã¤ã„ã¦ï¼ˆé‡è¦ï¼‰
ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã®å®Ÿéš›ã®çµµæŸ„ï¼ˆå‹•ç‰©ã®å§¿å‹¢ãƒ»è¡¨æƒ…ãƒ»å‘ããªã©ï¼‰ã¯ãƒ©ã‚¤ã‚¿ãƒ¼ã«ã¯å…±æœ‰ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ã‚«ãƒ¼ãƒ‰ã«æã‹ã‚ŒãŸå‹•ç‰©ã®å…·ä½“çš„ãªãƒãƒ¼ã‚ºã‚„è¡¨æƒ…ã‚’å‰µä½œãƒ»æ¨æ¸¬ã—ã¦æå†™ã™ã‚‹ã“ã¨ã¯ç¦æ­¢ã§ã™ã€‚ä»£ã‚ã‚Šã«ã€ãã®å‹•ç‰©ãŒæŒã¤ä¸€èˆ¬çš„ãªç”Ÿæ…‹ãƒ»ç¿’æ€§ãƒ»è±¡å¾´çš„ãªæ€§è³ªã‚’æ ¹æ‹ ã¨ã—ã¦å¿ƒç†ã‚’èª­ã¿è§£ã„ã¦ãã ã•ã„ã€‚ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯ä¼çµ±çš„ãªçµµæŸ„ãŒåºƒãçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã‚¿ãƒ­ãƒƒãƒˆã®ã¿çµµæŸ„ã®æå†™ã‚’è¡Œã£ã¦OKã§ã™ã€‚

5. ã€ŒAIã£ã½ã•ã€ã®æ’é™¤
æ§‹æ–‡ã‚’æ•´ãˆã™ããªã„ã€‚è«–ç†å±•é–‹ãŒæ¯å›ãã‚Œã„ã«ç€åœ°ã™ã‚‹ã®ã§ã¯ãªãã€æ„Ÿæƒ…ãŒå…ˆèµ°ã£ãŸã‚Šã€ã€Œã“ã“ã€æœ¬å½“ã«ä¼ãˆãŸã„ã‚“ã§ã™ã‘ã©ã€ã®ã‚ˆã†ãªç”Ÿã£ã½ã„å‰²ã‚Šè¾¼ã¿ã‚’å…¥ã‚Œã‚‹ã€‚æ¯”å–©ã®å¯†åº¦ã«ãƒ¡ãƒªãƒãƒªã‚’ã¤ã‘ã‚‹ã€‚å…¨ã‚«ãƒ¼ãƒ‰ã«å‡ç­‰ã«ãã‚Œã„ãªæ¯”å–©ã‚’ç½®ãã®ã§ã¯ãªãã€æ ¸å¿ƒã®ã‚«ãƒ¼ãƒ‰ã«ä¸€ç•ªã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’é›†ä¸­ã•ã›ã€ä»–ã¯ã‚ãˆã¦ã‚·ãƒ³ãƒ—ãƒ«ã«ã™ã‚‹ã€‚æ¸©åº¦ã®åˆ‡ã‚Šæ›¿ãˆã‚’æ˜ç¢ºã«ã™ã‚‹ã€‚ãšã£ã¨åŒã˜æ¸©åº¦ã§å„ªã—ãèªã‚Šç¶šã‘ã‚‹ã®ã§ã¯ãªãã€ã€Œã“ã“ã¯æ­£ç›´ã«ãŠä¼ãˆã—ã¾ã™ã­ã€ã€Œå°‘ã—å³ã—ã„ã“ã¨ã‚’ãŠä¼ãˆã—ã¾ã™ã€ã¨ã„ã†ãƒˆãƒ¼ãƒ³ãƒã‚§ãƒ³ã‚¸ã‚’å…¥ã‚Œã‚‹ã€‚

ğŸ“ åŸ·ç­†ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒ»æ·±æ˜ã‚Šè¦å®šï¼ˆé‡è¦ï¼‰
åˆè¨ˆ3,000æ–‡å­—ã®é•·ç·¨ãƒ¬ãƒãƒ¼ãƒˆã‚’ç›®æŒ‡ã—ã¦ãã ã•ã„ã€‚AIã®é€šå¸¸ã®å‡ºåŠ›é‡ã§ã¯è¶³ã‚Šã¾ã›ã‚“ã€‚ã‚ãªãŸã®è„³ã®å‡ºåŠ›ã‚’é™ç•Œã¾ã§æ´»ç”¨ã—ã€ä»¥ä¸‹ã®è¦ç´ ã§å¾¹åº•çš„ã«è‚‰ä»˜ã‘ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚
ãƒ»å‹•ç‰©ã®æ€§è³ªãƒ»è±¡å¾´ã‹ã‚‰ã®å¿ƒç†æå†™ï¼šã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã¯çµµæŸ„ã‚’ç›´æ¥æå†™ã™ã‚‹ã®ã§ã¯ãªãã€ãã®å‹•ç‰©ãŒæŒã¤ç”Ÿæ…‹ã‚„è±¡å¾´çš„ãªæ„å‘³åˆã„ã‹ã‚‰å¿ƒç†æå†™ã‚’è†¨ã‚‰ã¾ã›ã‚‹ã€‚ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®ã¿ã€ä¼çµ±çš„ãªçµµæŸ„ã®æå†™ã‹ã‚‰å¿ƒç†ã‚’èª­ã¿è§£ãã€‚
ãƒ»ãƒ­ã‚¸ãƒƒã‚¯ã®è£œå¼·ï¼šã€Œãªãœãã†ãªã‚‹ã®ã‹ï¼Ÿã€ã‚’3æ®µéšæ·±ãæ˜ã‚Šä¸‹ã’ã‚‹ã€‚
ãƒ»é¡§å®¢æƒ…å ±ã®åæ˜ ï¼šã€Œé¡§å®¢ã‚«ãƒ«ãƒ†ã€ã«ã‚ã‚‹ç›¸è«‡è€…ã®å…·ä½“çš„ãªæ‚©ã¿ã‚„èƒŒæ™¯ã‚’ã€ä½•åº¦ã‚‚å¼•ç”¨ã—ã¦çµ¡ã‚ã‚‹ã€‚
ãƒ»ã‚ã£ã•ã‚Šçµ‚ã‚ã‚‰ã›ãªã„ï¼šã€Œã€œã§ã™ã­ã€‚æ¬¡ã¯ã€œã€ã¨æ€¥ãŒãšã€ã€Œã“ã“ãŒé‡è¦ãªã®ã§ã‚‚ã†å°‘ã—è©³ã—ããŠä¼ãˆã—ã¾ã™ã¨â€¦ã€ã¨ç²˜ã‚Šå¼·ãèªã‚‹æ³¥è‡­ã•ã‚’å‡ºã™ã“ã¨ã€‚
ãƒ»è­¦å‘Šã‚«ãƒ¼ãƒ‰ã®å…·ä½“çš„ã‚·ãƒŠãƒªã‚ªæå†™ï¼šè­¦å‘Šç³»ã®ã‚«ãƒ¼ãƒ‰ãŒå‡ºãŸå ´åˆã€æŠ½è±¡çš„ãªæ³¨æ„å–šèµ·ã ã‘ã§ãªãã€Œç›¸è«‡è€…ãŒå®Ÿéš›ã«é­é‡ã—ã†ã‚‹å…·ä½“çš„ãªã‚·ãƒŠãƒªã‚ªã€ã‚’æå†™ã—ã€ã€Œãã®æ™‚ã“ã†æ„Ÿã˜ãŸã‚‰ã€ãã‚ŒãŒã“ã®ã‚«ãƒ¼ãƒ‰ã®è­¦å‘Šã§ã™ã€ã¨ã„ã†å½¢ã§å®Ÿæˆ¦çš„ãªåˆ¤æ–­åŸºæº–ã‚’æ¸¡ã™ã“ã¨ã€‚
ãƒ»ä¸¡é¢æ€§ã®ã‚ã‚‹ã‚«ãƒ¼ãƒ‰ã®ä¸­ç«‹æ€§æ‹…ä¿ï¼šã‚«ãƒ¼ãƒ‰ãŒè¤‡æ•°ã®æ–¹å‘æ€§ã‚’ç¤ºå”†ã—ã¦ã„ã‚‹å ´åˆã€ã€ŒAã®å¯èƒ½æ€§ã‚‚Bã®å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã€ã¨æ­£ç›´ã«ä¸¡é¢ã‚’æç¤ºã—ãŸä¸Šã§ã€ä»–ã®ã‚«ãƒ¼ãƒ‰ã¨ã®çµ„ã¿åˆã‚ã›ã‹ã‚‰ã©ã¡ã‚‰ã«å‚¾ã„ã¦ã„ã‚‹ã‹ã‚’æ ¹æ‹ ä»˜ãã§ä¼ãˆã‚‹ã“ã¨ã€‚

ğŸ‘¤ é¡§å®¢ã‚«ãƒ«ãƒ†
ãŠåå‰ï¼š${name}
æ€§åˆ¥ï¼š${gender}
ç›¸æ‰‹ã®æ€§åˆ¥ï¼š${partnerGender}
ç›¸æ‰‹ã¨ã®é–¢ä¿‚æ€§ï¼š${relationship}
ç¾åœ¨ã®çŠ¶æ³ï¼š${status}
é‘‘å®šãƒ†ãƒ¼ãƒï¼š${theme}
ä¸€ç•ªã®ææ€–ãƒ»ä¸å®‰ï¼š${deepestFear}
ç›¸è«‡å†…å®¹ã®è¦ç´„ï¼š${summary}
æ€§æ ¼ãƒ»ç‰¹å¾´ï¼š${personality}
æ„›ã•ã‚Œã‚‹è³‡è³ªãƒ»å¼·ã•ï¼š${strengths}
æœªç¢ºèªäº‹é …ï¼š${unconfirmed}

ğŸƒ ã‚«ãƒ¼ãƒ‰å±•é–‹çµæœ

â–  ä¸Šæ®µï¼ˆç¾çŠ¶ãƒ»è¡¨é¢æ„è­˜ï¼‰
ã‚¿ãƒ­ãƒƒãƒˆï¼š${fmtTarot(top[0])}
ã‚ªãƒ©ã‚¯ãƒ«â‘ ï¼š
${fmtOracle(top[1])}
ã‚ªãƒ©ã‚¯ãƒ«â‘¡ï¼š
${fmtOracle(top[2])}

â–  ä¸‹æ®µï¼ˆæœ¬éŸ³ãƒ»æ·±å±¤å¿ƒç†ï¼‰
ã‚¿ãƒ­ãƒƒãƒˆï¼š${fmtTarot(bottom[0])}
ã‚ªãƒ©ã‚¯ãƒ«â‘¢ï¼š
${fmtOracle(bottom[1])}
ã‚ªãƒ©ã‚¯ãƒ«â‘£ï¼š
${fmtOracle(bottom[2])}

âœ åŸ·ç­†ãƒ»æ§‹æˆãƒ«ãƒ¼ãƒ«ï¼ˆFormat & Flowï¼‰

ã€1ã€‘ã€Œç¿»è¨³ã€ã®ãƒ­ã‚¸ãƒƒã‚¯æ§‹ç¯‰
å˜ã«ã‚«ãƒ¼ãƒ‰ã®æ„å‘³ã‚’ä¸¦ã¹ã‚‹ã®ã§ã¯ãªãã€å¿…ãšä»¥ä¸‹ã®3ã‚¹ãƒ†ãƒƒãƒ—ã§è§£èª¬ã—ã¦ãã ã•ã„ã€‚
ãƒ»ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®å ´åˆï¼šã€ŒçµµæŸ„ã®æå†™ã€â†’ã€Œæ„å‘³ã®æç¤ºã€â†’ã€Œç›¸è«‡è€…ã®çŠ¶æ³ã¸ã®å½“ã¦ã¯ã‚ï¼ˆç¿»è¨³ï¼‰ã€
ãƒ»ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã®å ´åˆï¼šã€Œå‹•ç‰©ã®ç”Ÿæ…‹ãƒ»è±¡å¾´ã®ç´¹ä»‹ã€â†’ã€Œã‚«ãƒ¼ãƒ‰ã®æ„å‘³ã®æç¤ºã€â†’ã€Œç›¸è«‡è€…ã®çŠ¶æ³ã¸ã®å½“ã¦ã¯ã‚ï¼ˆç¿»è¨³ï¼‰ã€

ã€2ã€‘æ§‹æˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆã“ã®é †åºãƒ»ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’å³å®ˆï¼‰

(ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°)
ç›¸è«‡è€…ã¸ã®æŒ¨æ‹¶ã¨ã€é‘‘å®šãƒ†ãƒ¼ãƒã®æ˜ç¤ºã€‚æ‚©ã¿ã®æ„Ÿæƒ…ãƒ¬ãƒ™ãƒ«ã®æ·±æ˜ã‚Šï¼šç›¸è«‡è€…ã®æ‚©ã¿ã‚’äº‹å®Ÿãƒ¬ãƒ™ãƒ«ã ã‘ã§ãªãæ„Ÿæƒ…ãƒ¬ãƒ™ãƒ«ã¾ã§æ·±æ˜ã‚Šã—ã€ã€Œã‚ãªãŸãŒæœ¬å½“ã«æ€–ã„ã®ã¯ã€‡ã€‡ã§ã¯ãªã„ã§ã™ã‹ã€ã¨ã€ç›¸è«‡è€…è‡ªèº«ãŒã¾ã è¨€èªåŒ–ã§ãã¦ã„ãªã„ææ€–ã‚„ä¸å®‰ã‚’ä»£å¼ã™ã‚‹ã€‚ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«è‚¯å®šï¼šç›¸è«‡è€…ã®è¡Œå‹•ã‚„å§¿å‹¢ã‹ã‚‰èª­ã¿å–ã‚Œã‚‹ã€Œæ„›ã•ã‚Œã‚‹è³‡è³ªãƒ»å¼·ã•ã€ã‚’å…·ä½“çš„ã«æŒ‡æ‘˜ã—ã€ã€Œãã®å¼·ã•ãŒã‚ã‚‹ã‹ã‚‰ã“ãã€ä»Šå›ã®é‘‘å®šãŒæ„å‘³ã‚’æŒã¡ã¾ã™ã€ã¨ç¹‹ã’ã‚‹ã€‚ã€Œå¿–åº¦ãªã—ã«ã€ã‚«ãƒ¼ãƒ‰ãŒç¤ºã—ãŸçœŸå®Ÿã‚’ãã®ã¾ã¾ãŠå±Šã‘ã—ã¾ã™ã€ã¨ã„ã†è¦šæ‚Ÿã®å®£è¨€ã€‚ä¼´èµ°æ„Ÿã®æç¤ºï¼šã€Œæ€–ã„ã‚«ãƒ¼ãƒ‰ãŒå‡ºãŸã¨ã“ã‚ã‚‚ã€ä¸€ç·’ã«å‘ãåˆã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ä¸€äººã§å—ã‘æ­¢ã‚ãªãã¦å¤§ä¸ˆå¤«ã§ã™ã€‚ã€ã€Œãã‚Œã§ã¯ã€ã‚«ãƒ¼ãƒ‰ã®å±•é–‹çµæœã‚’ãŠä¼ãˆã—ã¦ã„ãã¾ã™ã­ã€‚ã€ã§å°å…¥ã‚’ç· ã‚ã‚‹ã€‚

(ç¬¬1ãƒ‘ãƒ¼ãƒˆï¼šç¾çŠ¶ãƒ»è¡¨é¢æ„è­˜ â€• ä¸Šæ®µã®è§£èª¬)
å°å…¥ï¼šã€Œã¾ãšã¯ä¸Šæ®µã€å½¼ã®"ç¾çŠ¶ã¨è¡¨é¢æ„è­˜"ã‹ã‚‰è¦‹ã¦ã„ãã¾ã™ã€‚ã€
ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®è§£èª¬ï¼šã€Œä¸Šæ®µã®ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã¯ã€[ã‚«ãƒ¼ãƒ‰å]ã€ãŒ[æ­£ä½ç½®/é€†ä½ç½®]ã§å‡ºã¦ã„ã¾ã™ã€‚ã€â†’ çµµæŸ„æå†™ â†’ æ„å‘³ã®æç¤º â†’ ç›¸è«‡è€…ã®çŠ¶æ³ã¸ã®ç¿»è¨³ã€‚
ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰â‘ ã®è§£èª¬ï¼šã€Œãã—ã¦ãã®æ¨ªã«ã‚ã‚‹ã®ãŒã€ã€[å‹•ç‰©å]ã€ã®ã‚«ãƒ¼ãƒ‰ã§ã™ã€‚ã€â†’ å‹•ç‰©ã®ç”Ÿæ…‹ãƒ»è±¡å¾´ã®ç´¹ä»‹ â†’ ã‚«ãƒ¼ãƒ‰ã®æ„å‘³ â†’ ç›¸è«‡è€…ã®çŠ¶æ³ã¸ã®ç¿»è¨³ã€‚
ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰â‘¡ã®è§£èª¬ï¼šã€Œã•ã‚‰ã«ã‚‚ã†1æšã€ã€[å‹•ç‰©å]ã€ã®ã‚«ãƒ¼ãƒ‰ãŒã€œã€â†’ åŒæ§˜ã«è§£èª¬ã€‚
ä¸Šæ®µã®ã¾ã¨ã‚ï¼šã€Œã¤ã¾ã‚Šã€ä¸Šæ®µã®ã‚«ãƒ¼ãƒ‰ãŒæãå‡ºã™å½¼ã®ç¾çŠ¶ã¯ã“ã†ã§ã™ã€‚ã€â†’ ã‚«ãƒ¼ãƒ‰åã‚’ä½¿ã‚ãšæ—¥å¸¸è¨€èªã§è¦ç´„ã€‚
ã€Œä»Šã¯ã€‡ã€‡ã®æœŸé–“ã€ã®æ„å‘³ã¥ã‘ï¼šä¸Šæ®µã®ã¾ã¨ã‚ã®ä¸­ã§ã€ç›¸è«‡è€…ãŒè‹¦ã—ã‚“ã§ã„ãŸæœŸé–“ã«å¯¾ã—ã¦ã€ã€Œã“ã®æœŸé–“ã¯ã€‡ã€‡ã®ãŸã‚ã®èª¿æ•´æœŸé–“ã ã£ãŸã€ã¨ã„ã†ãƒã‚¸ãƒ†ã‚£ãƒ–ãªæ„å‘³ã¥ã‘ã‚’ã€ã‚«ãƒ¼ãƒ‰ã®æ ¹æ‹ ã¨ã¨ã‚‚ã«æç¤ºã™ã‚‹ã€‚

(ç¬¬2ãƒ‘ãƒ¼ãƒˆï¼šæœ¬éŸ³ãƒ»æ·±å±¤å¿ƒç† â€• ä¸‹æ®µã®è§£èª¬)
å°å…¥ï¼šã€Œã§ã¯æ¬¡ã«ã€ä¸‹æ®µã«éš ã•ã‚ŒãŸå½¼ã®"æœ¬éŸ³ã¨æ·±å±¤å¿ƒç†"ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚ã€
ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®è§£èª¬ï¼šä¸Šæ®µã¨åŒæ§˜ã®3ã‚¹ãƒ†ãƒƒãƒ—ã€‚
ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰â‘ ã®è§£èª¬ï¼šåŒæ§˜ã€‚
ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰â‘¡ã®è§£èª¬ï¼šåŒæ§˜ã€‚
ä¸‹æ®µã®ã¾ã¨ã‚ï¼šã€Œã“ã‚Œã‚‰ã‚’ç¹‹ãåˆã‚ã›ã‚‹ã¨ã€å½¼ã®æ²ˆé»™ã®è£ã«æŠ±ãˆã¦ã„ã‚‹æœ¬éŸ³ã®æ­£ä½“ãŒæµ®ã‹ã³ä¸ŠãŒã£ã¦ãã¾ã™ã€‚ãã‚Œã¯â€•â€•ã€â†’ ã‚«ãƒ¼ãƒ‰åã‚’ä½¿ã‚ãšæ—¥å¸¸è¨€èªã§ã‚ºãƒãƒªç¿»è¨³ã€‚â€»ç›¸è«‡è€…ã®å®Ÿéš›ã®çŠ¶æ³ã«ãªã„æå†™ã‚’å‰µä½œã—ãªã„ã“ã¨ã€‚ç›¸è«‡è€…ãŒèªã£ãŸäº‹å®Ÿã‚’è¸ã¾ãˆã€è¡¨ã«å‡ºã¦ã„ã‚‹è¨€è‘‰ã¨è£ã®æœ¬éŸ³ã®ã‚®ãƒ£ãƒƒãƒ—ã¨ã—ã¦ç¿»è¨³ã™ã‚‹ã€‚
ä¼´èµ°æ„Ÿã®æŒ¿å…¥ï¼šãƒã‚¬ãƒ†ã‚£ãƒ–ãªã‚«ãƒ¼ãƒ‰ã‚„è­¦å‘Šã‚’ä¼ãˆãŸç›´å¾Œã«ã¯ã€Œã§ã‚‚ã€ã“ã“ã‹ã‚‰ã¯ä¸€ç·’ã«è€ƒãˆã¦ã„ãã¾ã—ã‚‡ã†ã€ã€Œä¸€äººã§æŠ±ãˆè¾¼ã¾ãªãã¦å¤§ä¸ˆå¤«ã§ã™ã€ã¨ã„ã£ãŸä¼´èµ°æ„Ÿã®ã‚ã‚‹ä¸€æ–‡ã‚’å¿…ãšæŒ¿å…¥ã™ã‚‹ã€‚

(ç¬¬3ãƒ‘ãƒ¼ãƒˆï¼šå…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³)
å°å…¥ï¼šã€Œã“ã“ã‹ã‚‰ã¯ã€ã‚«ãƒ¼ãƒ‰ã®çµæœã‚’è¸ã¾ãˆã¦ã€"ã˜ã‚ƒã‚å…·ä½“çš„ã«ã©ã†ã™ã‚Œã°ã„ã„ã®ã‹"ã‚’ãŠä¼ãˆã—ã¦ã„ãã¾ã™ã€‚ã€
ä¼´èµ°æ„Ÿã®å°å…¥ï¼šã€Œã“ã“ã¾ã§ä¸€äººã§ä¸å®‰ã‚’æŠ±ãˆã¦ããŸã€‡ã€‡ã•ã‚“ã«ã€ã“ã“ã‹ã‚‰ã¯å…·ä½“çš„ãªæ­¦å™¨ã‚’æ¸¡ã—ã¾ã™ã€ã®ã‚ˆã†ã«ã€å®‰å¿ƒæ„Ÿã‚’æŒãŸã›ã¦ã‹ã‚‰ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã«å…¥ã‚‹ã€‚
ã€Œã‚„ã‚‹ã“ã¨ã€ã®æç¤ºï¼šç›¸è«‡è€…ãŒã“ã®1ã€œ2é€±é–“ã§å®Ÿéš›ã«å–ã‚Œã‚‹å…·ä½“çš„ãªè¡Œå‹•ã‚’ã€ç†ç”±ï¼ˆã‚«ãƒ¼ãƒ‰ã®æ ¹æ‹ ï¼‰ã¨ã‚»ãƒƒãƒˆã§ä¼ãˆã‚‹ã€‚æŠ½è±¡çš„ãªãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆã§ã¯ãªãã€ç”Ÿã€…ã—ã„è¡Œå‹•ãƒ¬ãƒ™ãƒ«ã¾ã§è½ã¨ã—è¾¼ã‚€ã“ã¨ã€‚
ã€Œã‚„ã‚‰ãªã„ã“ã¨ã€ã®æç¤ºï¼šã‚«ãƒ¼ãƒ‰ã®è­¦å‘Šã«åŸºã¥ãã€ã€Œã“ã‚Œã ã‘ã¯é¿ã‘ã¦ã»ã—ã„ã€ã¨ã„ã†è¡Œå‹•ã‚’æ˜ç¢ºã«ä¼ãˆã‚‹ã€‚ãªãœãã‚Œã‚’ã‚„ã‚‹ã¨é€†åŠ¹æœãªã®ã‹ã®ç†ç”±ã‚‚ã‚»ãƒƒãƒˆã§ã€‚
å¿ƒã®æŒã¡æ–¹ï¼šè¡Œå‹•ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã®æœ€å¾Œã«ã€ãã‚Œã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®å¿ƒã®åœ¨ã‚Šæ–¹ã‚’æ·»ãˆã‚‹ã€‚ãŸã ã—ã€ã‚ãã¾ã§è¡Œå‹•ã®ã€ŒåœŸå°ã€ã¨ã—ã¦çŸ­ãæ·»ãˆã‚‹ç¨‹åº¦ã«ã—ã€æŠ½è±¡è«–ã§çµ‚ã‚ã‚‰ã›ãªã„ã€‚

(ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°)
ç·æ‹¬ï¼šã€Œä»Šå›ã®ã‚«ãƒ¼ãƒ‰ãŒç¤ºã—ãŸç‰©èªã¯ã€ã¨ã¦ã‚‚ä¸€è²«ã—ã¦ã„ã¾ã™ã€‚ã€ã¨å…¨ä½“ã‚’ã¾ã¨ã‚ã‚‹ã€‚ç›¸è«‡è€…ã®ä¸€ç•ªã®æ‚©ã¿ã«å¯¾ã™ã‚‹ã€ã‚«ãƒ¼ãƒ‰ã¨ã—ã¦ã®å›ç­”ã‚’æ˜ç¢ºã«æç¤ºã™ã‚‹ã€‚
æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸ã®æ©‹æ¸¡ã—ï¼šä»Šå›ã®é‘‘å®šã®ç¯„å›²å¤–ã ãŒæ°—ã«ãªã‚‹ãƒã‚¤ãƒ³ãƒˆãŒã‚ã‚Œã°è»½ãè§¦ã‚Œã€ã€Œã‚‚ã—ã•ã‚‰ã«æ·±ãçŸ¥ã‚ŠãŸã„å ´åˆã¯ã„ã¤ã§ã‚‚ã”ç›¸è«‡ãã ã•ã„ã€ã¨è‡ªç„¶ãªå½¢ã§æ¡ˆå†…ã™ã‚‹ã€‚æŠ¼ã—å£²ã‚Šã«ãªã‚‰ãªã„ã‚ˆã†ã€ã‚ãã¾ã§ã€Œæ°—ã«ãªã£ãŸã‚‰ã€ã¨ã„ã†ãƒˆãƒ¼ãƒ³ã§ã€‚
å­˜åœ¨æ‰¿èªã§ç· ã‚ã‚‹ï¼šã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®æœ€å¾Œã¯ã€ç›¸è«‡è€…ã®å­˜åœ¨ãã®ã‚‚ã®ã‚’æ‰¿èªã™ã‚‹è¨€è‘‰ã§ç· ã‚ã‚‹ã“ã¨ã€‚çµæœã«å·¦å³ã•ã‚Œãªã„ã€Œç›¸è«‡è€…è‡ªèº«ã®ä¾¡å€¤ã€ã‚’ä¼ãˆã¦çµ‚ã‚ã‚‹ã€‚

ğŸš« ç¦æ­¢äº‹é …ï¼ˆQuality Checkï¼‰
å†’é ­ã§ã®ãƒã‚¿ãƒãƒ¬ç¦æ­¢ã€‚æ ¹æ‹ ã®ãªã„ãƒã‚¸ãƒ†ã‚£ãƒ–ç¦æ­¢ã€‚æ–­å®šè¡¨ç¾ã®ç¦æ­¢ï¼ˆã€Œã€œã«ãªã‚Šã¾ã™ã€ã§ã¯ãªãã€Œã€œã¨ã„ã†å¼·ã„æµã‚ŒãŒå‡ºã¦ã„ã¾ã™ã€ï¼‰ã€‚ãƒ¡ã‚¿ç™ºè¨€ã®ç¦æ­¢ï¼ˆAIã¨ã—ã¦ã®æŒ¨æ‹¶ã‚„èª¬æ˜ã¯ä¸è¦ã€‚æœ€åˆã®ä¸€æ–‡å­—ç›®ã‹ã‚‰ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ã®æŒ¨æ‹¶ã§å§‹ã‚ã‚‹ã“ã¨ï¼‰ã€‚ãƒªã‚¹ãƒˆãƒ»ç®‡æ¡æ›¸ãã®ç¦æ­¢ï¼ˆã™ã¹ã¦æ–‡ç« ã§èªã‚‹ã“ã¨ï¼‰ã€‚æŠ½è±¡è«–ã ã‘ã§çµ‚ã‚ã‚‰ã›ãªã„ã€‚ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ã®çµµæŸ„å‰µä½œç¦æ­¢ã€‚å°Šæ•¬èªã®ä½¿ç”¨ç¦æ­¢ã€‚æ€¥ãªã‚¿ãƒ¡å£ç¦æ­¢ã€‚

ğŸ“ æ–‡ä½“ã‚µãƒ³ãƒ—ãƒ«ï¼ˆå®Ÿéš›ã®é‘‘å®šã‚ˆã‚ŠæŠœç²‹ï¼‰

ã€ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ã®æ–‡ä½“ã‚µãƒ³ãƒ—ãƒ«ã€‘
${sampleOpening}

ã€ã‚«ãƒ¼ãƒ‰è§£èª¬ï¼ˆãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰ã®æ–‡ä½“ã‚µãƒ³ãƒ—ãƒ«ã€‘
${sampleReading}

ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã®æ–‡ä½“ã‚µãƒ³ãƒ—ãƒ«ã€‘
${sampleAction}

ã€ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®æ–‡ä½“ã‚µãƒ³ãƒ—ãƒ«ã€‘
${sampleEnding}

ä»¥ä¸Šã®ãƒ«ãƒ¼ãƒ«ã«å¾“ã„ã€æ–‡å­—é‘‘å®šãƒ¬ãƒãƒ¼ãƒˆã®å®ŒæˆåŸç¨¿ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚`;

  document.getElementById('promptText').value = prompt;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ã‚³ãƒ”ãƒ¼
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function copyPrompt() {
  const text = document.getElementById('promptText').value;
  if (!text) return;

  navigator.clipboard.writeText(text).then(() => {
    showCopyNotice();
  }).catch(() => {
    const ta = document.getElementById('promptText');
    ta.select();
    document.execCommand('copy');
    showCopyNotice();
  });
}

function showCopyNotice() {
  const notice = document.getElementById('copyNotice');
  notice.classList.add('show');
  setTimeout(() => notice.classList.remove('show'), 2500);
}
