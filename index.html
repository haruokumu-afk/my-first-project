<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ã‚¿ãƒ­ãƒƒãƒˆé‘‘å®šã‚µãƒãƒ¼ãƒˆ</title>
  <style>
    /* â”€â”€ ãƒªã‚»ãƒƒãƒˆ & ãƒ™ãƒ¼ã‚¹ â”€â”€ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #0d0a1a;
      --surface: #1a1430;
      --surface2: #231c42;
      --border: #3d2f6e;
      --gold: #c9a84c;
      --gold-light: #f0d080;
      --text: #e8e0f8;
      --text-muted: #9988cc;
      --tarot: #7b4fcf;
      --tarot-light: #a97ee8;
      --oracle: #2e7d9c;
      --oracle-light: #5db8d8;
      --radius: 12px;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', sans-serif;
      min-height: 100vh;
      padding: 24px 16px 60px;
    }

    /* â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼ â”€â”€ */
    header {
      text-align: center;
      margin-bottom: 36px;
    }
    header h1 {
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--gold), var(--gold-light), var(--gold));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 0.12em;
    }
    header p {
      color: var(--text-muted);
      font-size: 0.85rem;
      margin-top: 6px;
      letter-spacing: 0.06em;
    }
    .stars {
      font-size: 1.2rem;
      letter-spacing: 0.3em;
      margin-bottom: 8px;
    }

    /* â”€â”€ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¹… â”€â”€ */
    .container {
      max-width: 860px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 28px;
    }

    /* â”€â”€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚«ãƒ¼ãƒ‰ â”€â”€ */
    .section {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px 28px;
    }
    .section-title {
      font-size: 1rem;
      font-weight: 700;
      color: var(--gold);
      letter-spacing: 0.08em;
      margin-bottom: 18px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border);
    }
    .section-title span {
      display: inline-block;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 2px 10px;
      font-size: 0.75rem;
      margin-right: 8px;
      color: var(--gold-light);
    }

    /* â”€â”€ ãƒ•ã‚©ãƒ¼ãƒ  â”€â”€ */
    .form-grid {
      display: grid;
      gap: 16px;
    }
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    @media (max-width: 600px) {
      .form-row { grid-template-columns: 1fr; }
    }
    label {
      display: block;
      font-size: 0.82rem;
      color: var(--text-muted);
      margin-bottom: 6px;
      letter-spacing: 0.04em;
    }
    input[type="text"], textarea {
      width: 100%;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-size: 0.95rem;
      padding: 10px 14px;
      outline: none;
      transition: border-color 0.2s;
      font-family: inherit;
      resize: vertical;
    }
    input[type="text"]:focus, textarea:focus {
      border-color: var(--gold);
    }
    textarea { min-height: 90px; }

    /* â”€â”€ ãƒœã‚¿ãƒ³ â”€â”€ */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-family: inherit;
      font-weight: 700;
      letter-spacing: 0.06em;
      transition: transform 0.15s, opacity 0.15s;
    }
    .btn:active { transform: scale(0.97); }
    .btn-primary {
      background: linear-gradient(135deg, #6034b8, var(--tarot));
      color: #fff;
      font-size: 1.05rem;
      padding: 13px 32px;
    }
    .btn-primary:hover { opacity: 0.88; }
    .btn-copy {
      background: var(--surface2);
      border: 1px solid var(--border);
      color: var(--text);
      font-size: 0.88rem;
      padding: 8px 18px;
    }
    .btn-copy:hover { border-color: var(--gold); color: var(--gold); }
    .btn-center { display: flex; justify-content: center; }

    /* â”€â”€ ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºã‚¨ãƒªã‚¢ â”€â”€ */
    .card-stage {
      display: none;
      flex-direction: column;
      gap: 20px;
    }
    .card-stage.show { display: flex; }

    .row-label {
      font-size: 0.78rem;
      color: var(--text-muted);
      letter-spacing: 0.08em;
      margin-bottom: 8px;
    }

    .card-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
    }
    @media (max-width: 520px) {
      .card-row { grid-template-columns: 1fr; }
    }

    .card-item {
      border-radius: 10px;
      padding: 16px 14px;
      text-align: center;
      position: relative;
      border: 1px solid transparent;
    }
    .card-item.tarot-card {
      background: linear-gradient(160deg, #2a1a50, #1e1238);
      border-color: var(--tarot);
    }
    .card-item.oracle-card {
      background: linear-gradient(160deg, #0d2535, #091b2a);
      border-color: var(--oracle);
    }

    .card-type-badge {
      display: inline-block;
      font-size: 0.68rem;
      letter-spacing: 0.06em;
      padding: 2px 8px;
      border-radius: 4px;
      margin-bottom: 10px;
      font-weight: 700;
    }
    .tarot-card .card-type-badge {
      background: var(--tarot);
      color: #fff;
    }
    .oracle-card .card-type-badge {
      background: var(--oracle);
      color: #fff;
    }

    .card-symbol {
      font-size: 2rem;
      margin-bottom: 8px;
      display: block;
    }

    .card-name {
      font-size: 1rem;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 6px;
      line-height: 1.3;
    }

    .card-position {
      display: inline-block;
      font-size: 0.75rem;
      padding: 2px 10px;
      border-radius: 20px;
      font-weight: 600;
    }
    .pos-upright {
      background: rgba(201,168,76,0.15);
      color: var(--gold-light);
      border: 1px solid rgba(201,168,76,0.4);
    }
    .pos-reversed {
      background: rgba(180,60,60,0.15);
      color: #e88888;
      border: 1px solid rgba(180,60,60,0.35);
      transform: rotate(180deg);
      display: inline-block;
    }
    .card-item.reversed-card .card-symbol,
    .card-item.reversed-card .card-name {
      opacity: 0.85;
    }

    .divider {
      border: none;
      border-top: 1px solid var(--border);
      margin: 4px 0;
    }

    /* â”€â”€ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ â”€â”€ */
    .prompt-area {
      display: none;
    }
    .prompt-area.show { display: block; }

    .prompt-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 14px;
      flex-wrap: wrap;
      gap: 10px;
    }

    #promptText {
      width: 100%;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-size: 0.88rem;
      padding: 14px;
      min-height: 340px;
      resize: vertical;
      font-family: 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', monospace;
      line-height: 1.7;
      outline: none;
    }
    #promptText:focus { border-color: var(--gold); }

    .copy-notice {
      display: none;
      font-size: 0.8rem;
      color: #88e8a0;
      margin-left: 10px;
    }
    .copy-notice.show { display: inline; }

    /* â”€â”€ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ â”€â”€ */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(16px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .card-item { animation: fadeInUp 0.4s ease both; }
    .card-row .card-item:nth-child(1) { animation-delay: 0.05s; }
    .card-row .card-item:nth-child(2) { animation-delay: 0.15s; }
    .card-row .card-item:nth-child(3) { animation-delay: 0.25s; }
  </style>
</head>
<body>

<header>
  <div class="stars">âœ¦ âœ§ âœ¦</div>
  <h1>ã‚¿ãƒ­ãƒƒãƒˆé‘‘å®šã‚µãƒãƒ¼ãƒˆ</h1>
  <p>ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã„ã¦ã€é‘‘å®šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™</p>
</header>

<div class="container">

  <!-- â‘  é¡§å®¢æƒ…å ± -->
  <div class="section">
    <div class="section-title"><span>STEP 1</span>é¡§å®¢æƒ…å ±ã®å…¥åŠ›</div>
    <div class="form-grid">
      <div class="form-row">
        <div>
          <label for="clientName">ç›¸è«‡è€…ã®ãŠåå‰</label>
          <input type="text" id="clientName" placeholder="ä¾‹ï¼šå±±ç”° èŠ±å­ æ§˜" />
        </div>
        <div>
          <label for="readingTheme">é‘‘å®šãƒ†ãƒ¼ãƒ</label>
          <input type="text" id="readingTheme" placeholder="ä¾‹ï¼šè»¢è·ãƒ»æ‹æ„›ãƒ»äººé–“é–¢ä¿‚" />
        </div>
      </div>
      <div>
        <label for="summary">ç›¸è«‡å†…å®¹ã®è¦ç´„</label>
        <textarea id="summary" placeholder="ä¾‹ï¼šä»Šã®ä»•äº‹ã‚’ç¶šã‘ã‚‹ã¹ãã‹æ‚©ã‚“ã§ã„ã‚‹ã€‚æ–°ã—ã„è·å ´ã®ã‚ªãƒ•ã‚¡ãƒ¼ãŒã‚ã‚‹ãŒè¸ã¿åˆ‡ã‚Œãªã„ã€‚"></textarea>
      </div>
    </div>
  </div>

  <!-- â‘¡ ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã -->
  <div class="section">
    <div class="section-title"><span>STEP 2</span>ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã</div>
    <div class="btn-center" style="margin-bottom: 24px;">
      <button class="btn btn-primary" id="drawBtn" onclick="drawCards()">
        âœ¦ ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã âœ¦
      </button>
    </div>

    <div class="card-stage" id="cardStage">
      <div>
        <div class="row-label">â–² ä¸Šæ®µï¼ˆç¾çŠ¶ãƒ»èª²é¡Œï¼‰</div>
        <div class="card-row" id="topRow"></div>
      </div>
      <hr class="divider" />
      <div>
        <div class="row-label">â–¼ ä¸‹æ®µï¼ˆã‚¢ãƒ‰ãƒã‚¤ã‚¹ãƒ»æœªæ¥ï¼‰</div>
        <div class="card-row" id="bottomRow"></div>
      </div>
    </div>
  </div>

  <!-- â‘¢ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ -->
  <div class="section prompt-area" id="promptSection">
    <div class="section-title"><span>STEP 3</span>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè‡ªå‹•ç”Ÿæˆ</div>
    <div class="prompt-header">
      <div style="font-size:0.85rem; color:var(--text-muted);">
        ä»¥ä¸‹ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€AIã¸è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„
      </div>
      <div>
        <button class="btn btn-copy" onclick="copyPrompt()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
        <span class="copy-notice" id="copyNotice">âœ“ ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</span>
      </div>
    </div>
    <textarea id="promptText" readonly></textarea>
  </div>

</div><!-- /container -->

<script>
  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ãƒ‡ãƒ¼ã‚¿å®šç¾©
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

  // ã‚¿ãƒ­ãƒƒãƒˆ 78æš
  const TAROT = [
    // å¤§ã‚¢ãƒ«ã‚«ãƒŠï¼ˆ22æšï¼‰
    'æ„šè€…ï¼ˆ0ï¼‰', 'é­”è¡“å¸«ï¼ˆâ… ï¼‰', 'å¥³æ•™çš‡ï¼ˆâ…¡ï¼‰', 'å¥³å¸ï¼ˆâ…¢ï¼‰', 'çš‡å¸ï¼ˆâ…£ï¼‰',
    'æ•™çš‡ï¼ˆâ…¤ï¼‰', 'æ‹äººãŸã¡ï¼ˆâ…¥ï¼‰', 'æˆ¦è»Šï¼ˆâ…¦ï¼‰', 'åŠ›ï¼ˆâ…§ï¼‰', 'éš è€…ï¼ˆâ…¨ï¼‰',
    'é‹å‘½ã®è¼ªï¼ˆâ…©ï¼‰', 'æ­£ç¾©ï¼ˆâ…ªï¼‰', 'åŠã‚‹ã•ã‚ŒãŸç”·ï¼ˆâ…«ï¼‰', 'æ­»ç¥ï¼ˆâ…©â…¢ï¼‰',
    'ç¯€åˆ¶ï¼ˆâ…©â…£ï¼‰', 'æ‚ªé­”ï¼ˆâ…©â…¤ï¼‰', 'å¡”ï¼ˆâ…©â…¥ï¼‰', 'æ˜Ÿï¼ˆâ…©â…¦ï¼‰', 'æœˆï¼ˆâ…©â…§ï¼‰',
    'å¤ªé™½ï¼ˆâ…©â…¨ï¼‰', 'å¯©åˆ¤ï¼ˆâ…©â…©ï¼‰', 'ä¸–ç•Œï¼ˆâ…©â…ªï¼‰',
    // ãƒ¯ãƒ³ãƒ‰ï¼ˆ14æšï¼‰
    'ãƒ¯ãƒ³ãƒ‰ã®ã‚¨ãƒ¼ã‚¹', 'ãƒ¯ãƒ³ãƒ‰ã®2', 'ãƒ¯ãƒ³ãƒ‰ã®3', 'ãƒ¯ãƒ³ãƒ‰ã®4', 'ãƒ¯ãƒ³ãƒ‰ã®5',
    'ãƒ¯ãƒ³ãƒ‰ã®6', 'ãƒ¯ãƒ³ãƒ‰ã®7', 'ãƒ¯ãƒ³ãƒ‰ã®8', 'ãƒ¯ãƒ³ãƒ‰ã®9', 'ãƒ¯ãƒ³ãƒ‰ã®10',
    'ãƒ¯ãƒ³ãƒ‰ã®ãƒšã‚¤ã‚¸', 'ãƒ¯ãƒ³ãƒ‰ã®ãƒŠã‚¤ãƒˆ', 'ãƒ¯ãƒ³ãƒ‰ã®ã‚¯ã‚¤ãƒ¼ãƒ³', 'ãƒ¯ãƒ³ãƒ‰ã®ã‚­ãƒ³ã‚°',
    // ã‚«ãƒƒãƒ—ï¼ˆ14æšï¼‰
    'ã‚«ãƒƒãƒ—ã®ã‚¨ãƒ¼ã‚¹', 'ã‚«ãƒƒãƒ—ã®2', 'ã‚«ãƒƒãƒ—ã®3', 'ã‚«ãƒƒãƒ—ã®4', 'ã‚«ãƒƒãƒ—ã®5',
    'ã‚«ãƒƒãƒ—ã®6', 'ã‚«ãƒƒãƒ—ã®7', 'ã‚«ãƒƒãƒ—ã®8', 'ã‚«ãƒƒãƒ—ã®9', 'ã‚«ãƒƒãƒ—ã®10',
    'ã‚«ãƒƒãƒ—ã®ãƒšã‚¤ã‚¸', 'ã‚«ãƒƒãƒ—ã®ãƒŠã‚¤ãƒˆ', 'ã‚«ãƒƒãƒ—ã®ã‚¯ã‚¤ãƒ¼ãƒ³', 'ã‚«ãƒƒãƒ—ã®ã‚­ãƒ³ã‚°',
    // ã‚½ãƒ¼ãƒ‰ï¼ˆ14æšï¼‰
    'ã‚½ãƒ¼ãƒ‰ã®ã‚¨ãƒ¼ã‚¹', 'ã‚½ãƒ¼ãƒ‰ã®2', 'ã‚½ãƒ¼ãƒ‰ã®3', 'ã‚½ãƒ¼ãƒ‰ã®4', 'ã‚½ãƒ¼ãƒ‰ã®5',
    'ã‚½ãƒ¼ãƒ‰ã®6', 'ã‚½ãƒ¼ãƒ‰ã®7', 'ã‚½ãƒ¼ãƒ‰ã®8', 'ã‚½ãƒ¼ãƒ‰ã®9', 'ã‚½ãƒ¼ãƒ‰ã®10',
    'ã‚½ãƒ¼ãƒ‰ã®ãƒšã‚¤ã‚¸', 'ã‚½ãƒ¼ãƒ‰ã®ãƒŠã‚¤ãƒˆ', 'ã‚½ãƒ¼ãƒ‰ã®ã‚¯ã‚¤ãƒ¼ãƒ³', 'ã‚½ãƒ¼ãƒ‰ã®ã‚­ãƒ³ã‚°',
    // ãƒšãƒ³ã‚¿ã‚¯ãƒ«ï¼ˆ14æšï¼‰
    'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ã‚¨ãƒ¼ã‚¹', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®2', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®3', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®4', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®5',
    'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®6', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®7', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®8', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®9', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®10',
    'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ãƒšã‚¤ã‚¸', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ãƒŠã‚¤ãƒˆ', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ã‚¯ã‚¤ãƒ¼ãƒ³', 'ãƒšãƒ³ã‚¿ã‚¯ãƒ«ã®ã‚­ãƒ³ã‚°',
  ];

  // ã‚ªãƒ©ã‚¯ãƒ« 52æš
  const ORACLE = [
    'æ„›ã®å…‰', 'ä¿¡é ¼', 'è§£æ”¾', 'å¤‰å®¹', 'è±Šã‹ã•', 'å†…ãªã‚‹çŸ¥æµ', 'æ–°ã—ã„å§‹ã¾ã‚Š',
    'å®ˆè­·', 'ç›´æ„Ÿ', 'ç™’ã—', 'æ„Ÿè¬', 'å¥‡è·¡', 'å¹³å’Œ', 'å‹‡æ°—', 'å‰µé€ æ€§', 'ç¹æ „',
    'èª¿å’Œ', 'å–œã³', 'è‡ªç”±', 'æµ„åŒ–', 'æˆé•·', 'å¸Œæœ›', 'å¼·ã•', 'æ…ˆæ‚²', 'å¤¢',
    'çœŸå®Ÿ', 'ãƒãƒ©ãƒ³ã‚¹', 'å°ã', 'å—å®¹', 'å†ç”Ÿ', 'ç¥ç¦', 'æ˜æ™°ã•', 'æƒ…ç†±',
    'å¿è€', 'æˆåŠŸ', 'ç¥è–ãªæ„›', 'éœŠçš„è¦šé†’', 'è±Šç©£', 'æ·±ã„ã¤ãªãŒã‚Š', 'å†…çœ',
    'å¤‰åŒ–ã®é¢¨', 'æµã‚Œã«ä¹—ã‚‹', 'å¢ƒç•Œç·š', 'è‡ªå·±æ„›', 'å¥½å¥‡å¿ƒ', 'è–ãªã‚‹å¥³æ€§æ€§',
    'ç¥è–ãªç”·æ€§æ€§', 'çµ±åˆ', 'æ‰‹æ”¾ã—', 'æ–°ã—ã„ç« ', 'å…‰ã®ç›®è¦šã‚', 'å¥‡è·¡ã®ç¨®',
  ];

  // ã‚¹ãƒ¼ãƒˆåˆ¥çµµæ–‡å­—
  const TAROT_SYMBOL = {
    'å¤§ã‚¢ãƒ«ã‚«ãƒŠ': 'âœ¨',
    'ãƒ¯ãƒ³ãƒ‰': 'ğŸ”¥',
    'ã‚«ãƒƒãƒ—': 'ğŸ’§',
    'ã‚½ãƒ¼ãƒ‰': 'âš¡',
    'ãƒšãƒ³ã‚¿ã‚¯ãƒ«': 'ğŸŒ¿',
  };
  const ORACLE_SYMBOLS = ['ğŸŒ™','â­','ğŸŒ¸','ğŸ¦‹','ğŸŒº','ğŸŒˆ','ğŸ”®','ğŸŒŸ','ğŸ’','ğŸŒŠ','â˜€ï¸','ğŸŒ¿'];

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

  function shuffle(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  function pick(arr, n) {
    return shuffle(arr).slice(0, n);
  }

  function randomPosition() {
    return Math.random() < 0.5 ? 'æ­£ä½ç½®' : 'é€†ä½ç½®';
  }

  function getSymbol(cardName) {
    if (ORACLE.includes(cardName)) {
      return ORACLE_SYMBOLS[Math.floor(Math.random() * ORACLE_SYMBOLS.length)];
    }
    const idx = TAROT.indexOf(cardName);
    if (idx < 22) return TAROT_SYMBOL['å¤§ã‚¢ãƒ«ã‚«ãƒŠ'];
    if (idx < 36) return TAROT_SYMBOL['ãƒ¯ãƒ³ãƒ‰'];
    if (idx < 50) return TAROT_SYMBOL['ã‚«ãƒƒãƒ—'];
    if (idx < 64) return TAROT_SYMBOL['ã‚½ãƒ¼ãƒ‰'];
    return TAROT_SYMBOL['ãƒšãƒ³ã‚¿ã‚¯ãƒ«'];
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ã‚«ãƒ¼ãƒ‰æç”»
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

  function renderCard(card, isTarot) {
    const pos = randomPosition();
    const reversed = pos === 'é€†ä½ç½®';
    const symbol = getSymbol(card);
    const typeLabel = isTarot ? 'ã‚¿ãƒ­ãƒƒãƒˆ' : 'ã‚ªãƒ©ã‚¯ãƒ«';
    const typeClass = isTarot ? 'tarot-card' : 'oracle-card';

    return {
      html: `
        <div class="card-item ${typeClass}${reversed ? ' reversed-card' : ''}">
          <div class="card-type-badge">${typeLabel}</div>
          <span class="card-symbol">${symbol}</span>
          <div class="card-name">${card}</div>
          <span class="card-position ${reversed ? 'pos-reversed' : 'pos-upright'}">${pos}</span>
        </div>`,
      text: `${card}ï¼ˆ${pos}ï¼‰`,
    };
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ãƒ¡ã‚¤ãƒ³ï¼šã‚«ãƒ¼ãƒ‰ã‚’å¼•ã
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

  let drawnCards = null;

  function drawCards() {
    const [t1, t2] = pick(TAROT, 2).map(c => ({ name: c, pos: randomPosition(), isTarot: true  }));
    const [o1, o2, o3, o4] = pick(ORACLE, 4).map(c => ({ name: c, pos: randomPosition(), isTarot: false }));

    // ä¸Šæ®µï¼šã‚¿ãƒ­ãƒƒãƒˆ1 + ã‚ªãƒ©ã‚¯ãƒ«1 + ã‚ªãƒ©ã‚¯ãƒ«2
    // ä¸‹æ®µï¼šã‚¿ãƒ­ãƒƒãƒˆ2 + ã‚ªãƒ©ã‚¯ãƒ«3 + ã‚ªãƒ©ã‚¯ãƒ«4
    const topCards    = [t1, o1, o2];
    const bottomCards = [t2, o3, o4];
    drawnCards = { top: topCards, bottom: bottomCards };

    // DOM æ›´æ–°
    const topRow    = document.getElementById('topRow');
    const bottomRow = document.getElementById('bottomRow');
    topRow.innerHTML    = '';
    bottomRow.innerHTML = '';

    [...topCards, ...bottomCards].forEach((card, i) => {
      const row = i < 3 ? topRow : bottomRow;
      const sym    = getSymbol(card.name);
      const rev    = card.pos === 'é€†ä½ç½®';
      const tClass = card.isTarot ? 'tarot-card' : 'oracle-card';
      const badge  = card.isTarot ? 'ã‚¿ãƒ­ãƒƒãƒˆ' : 'ã‚ªãƒ©ã‚¯ãƒ«';
      row.innerHTML += `
        <div class="card-item ${tClass}${rev ? ' reversed-card' : ''}">
          <div class="card-type-badge">${badge}</div>
          <span class="card-symbol">${sym}</span>
          <div class="card-name">${card.name}</div>
          <span class="card-position ${rev ? 'pos-reversed' : 'pos-upright'}">${card.pos}</span>
        </div>`;
    });

    document.getElementById('cardStage').classList.add('show');

    // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
    generatePrompt();
    document.getElementById('promptSection').classList.add('show');

    // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    setTimeout(() => {
      document.getElementById('cardStage').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 100);
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

  function generatePrompt() {
    const name    = document.getElementById('clientName').value.trim()  || 'ï¼ˆåå‰æœªå…¥åŠ›ï¼‰';
    const theme   = document.getElementById('readingTheme').value.trim() || 'ï¼ˆãƒ†ãƒ¼ãƒæœªå…¥åŠ›ï¼‰';
    const summary = document.getElementById('summary').value.trim()      || 'ï¼ˆç›¸è«‡å†…å®¹æœªå…¥åŠ›ï¼‰';

    const { top, bottom } = drawnCards;

    const fmt = (c) => `${c.name}ï¼ˆ${c.pos}ï¼‰`;

    const prompt = `ã‚ãªãŸã¯ãƒ—ãƒ­ã®ã‚¿ãƒ­ãƒƒãƒˆå ã„å¸«ã§ã™ã€‚ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚‚ã¨ã«ã€ç›¸è«‡è€…ã«å¯„ã‚Šæ·»ã£ãŸä¸å¯§ã§æ·±ã¿ã®ã‚ã‚‹é‘‘å®šæ–‡ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ç›¸è«‡è€…æƒ…å ±ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ãŠåå‰ï¼š${name}
é‘‘å®šãƒ†ãƒ¼ãƒï¼š${theme}
ç›¸è«‡å†…å®¹ï¼š${summary}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ã‚«ãƒ¼ãƒ‰çµæœã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â–² ä¸Šæ®µï¼ˆç¾çŠ¶ãƒ»èª²é¡Œï¼‰
  ãƒ»ã‚¿ãƒ­ãƒƒãƒˆ  ï¼š${fmt(top[0])}
  ãƒ»ã‚ªãƒ©ã‚¯ãƒ«â‘  ï¼š${fmt(top[1])}
  ãƒ»ã‚ªãƒ©ã‚¯ãƒ«â‘¡ ï¼š${fmt(top[2])}

â–¼ ä¸‹æ®µï¼ˆã‚¢ãƒ‰ãƒã‚¤ã‚¹ãƒ»æœªæ¥ã®å¯èƒ½æ€§ï¼‰
  ãƒ»ã‚¿ãƒ­ãƒƒãƒˆ  ï¼š${fmt(bottom[0])}
  ãƒ»ã‚ªãƒ©ã‚¯ãƒ«â‘¢ ï¼š${fmt(bottom[1])}
  ãƒ»ã‚ªãƒ©ã‚¯ãƒ«â‘£ ï¼š${fmt(bottom[2])}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€é‘‘å®šæ–‡ä½œæˆã®æŒ‡é‡ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. å†’é ­ã§ç›¸è«‡å†…å®¹ã¨é‘‘å®šãƒ†ãƒ¼ãƒã¸ã®å…±æ„Ÿã‚’ç¤ºã—ã€å¼•ã„ãŸã‚«ãƒ¼ãƒ‰ã®å…¨ä½“çš„ãªå°è±¡ã‚’ä¼ãˆã¦ãã ã•ã„ã€‚

2. ã€ä¸Šæ®µã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‘
   ä¸Šæ®µ3æšã®ã‚«ãƒ¼ãƒ‰ï¼ˆç¾çŠ¶ãƒ»èª²é¡Œï¼‰ã‚’è§£é‡ˆã—ã¦ãã ã•ã„ã€‚
   ãƒ»ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ãŒç¤ºã™ç¾åœ¨ã®çŠ¶æ³ã‚„æ ¸å¿ƒ
   ãƒ»2æšã®ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ãŒåŠ ãˆã‚‹ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
   ãƒ»3æšã‚’çµ±åˆã—ãŸã€Œä»Šã‚ãªãŸãŒç½®ã‹ã‚Œã¦ã„ã‚‹çŠ¶æ³ã€ã®ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

3. ã€ä¸‹æ®µã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‘
   ä¸‹æ®µ3æšã®ã‚«ãƒ¼ãƒ‰ï¼ˆã‚¢ãƒ‰ãƒã‚¤ã‚¹ãƒ»æœªæ¥ï¼‰ã‚’è§£é‡ˆã—ã¦ãã ã•ã„ã€‚
   ãƒ»ã‚¿ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ãŒç¤ºã™è»¢æ›ç‚¹ã‚„æœªæ¥ã®æ–¹å‘æ€§
   ãƒ»2æšã®ã‚ªãƒ©ã‚¯ãƒ«ã‚«ãƒ¼ãƒ‰ãŒä¼ãˆã‚‹è¡Œå‹•ã®ãƒ’ãƒ³ãƒˆã‚„å®‡å®™ã‹ã‚‰ã®ã‚µãƒãƒ¼ãƒˆ
   ãƒ»3æšã‚’çµ±åˆã—ãŸã€Œã“ã‚Œã‹ã‚‰ã®ã‚ãªãŸã¸ã®ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ã€ã®ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

4. ã¾ã¨ã‚ã¨ã—ã¦ã€ä¸Šæ®µã¨ä¸‹æ®µã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èåˆã•ã›ã€ç›¸è«‡è€…ã¸ã®ã‚¨ãƒ¼ãƒ«ã¨å‰å‘ããªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ç· ã‚ããã£ã¦ãã ã•ã„ã€‚

ã€æ–‡ä½“ã®æ³¨æ„ç‚¹ã€‘
- æ¸©ã‹ãã€ç›¸è«‡è€…ã«å¯„ã‚Šæ·»ã†ãƒˆãƒ¼ãƒ³ã§
- æ–­å®šçš„ã™ããšã€å¯èƒ½æ€§ã‚’åºƒã’ã‚‹è¡¨ç¾ã‚’ä½¿ã†
- ç›¸è«‡è€…ãŒè‡ªåˆ†ã§æ±ºæ–­ã§ãã‚‹ã‚ˆã†å¾ŒæŠ¼ã—ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¿ƒãŒã‘ã‚‹
- æ•¬èªï¼ˆä¸å¯§èªï¼‰ã§çµ±ä¸€ã™ã‚‹
- åˆ†é‡ã®ç›®å®‰ï¼šå…¨ä½“ã§1,000ã€œ1,500å­—ç¨‹åº¦`;

    document.getElementById('promptText').value = prompt;
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ã‚³ãƒ”ãƒ¼
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

  function copyPrompt() {
    const text = document.getElementById('promptText').value;
    if (!text) return;

    navigator.clipboard.writeText(text).then(() => {
      const notice = document.getElementById('copyNotice');
      notice.classList.add('show');
      setTimeout(() => notice.classList.remove('show'), 2500);
    }).catch(() => {
      // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
      const ta = document.getElementById('promptText');
      ta.select();
      document.execCommand('copy');
      const notice = document.getElementById('copyNotice');
      notice.classList.add('show');
      setTimeout(() => notice.classList.remove('show'), 2500);
    });
  }

  /* â”€â”€â”€ é¡§å®¢æƒ…å ±å¤‰æ›´æ™‚ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å†ç”Ÿæˆ â”€â”€â”€ */
  ['clientName', 'readingTheme', 'summary'].forEach(id => {
    document.getElementById(id).addEventListener('input', () => {
      if (drawnCards) generatePrompt();
    });
  });
</script>
</body>
</html>
